<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Soulify - Connect with strangers and chat anonymously">
  <meta name="keywords" content="chat, anonymous, strangers, connect, soulify">
  <meta name="theme-color" content="#6366f1">
  <title>Soulify - Connect & Chat</title>
  <link rel="stylesheet" href="style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <script src="/socket.io/socket.io.js"></script>
</head>
<body>
  <div id="container">
    <header class="rounded-container">
      <img src="soulify-logo.png" alt="Soulify Logo" class="app-logo">
      <span id="onlineUsers">Online Users: <span id="onlineCount">0</span></span>
      <button id="toggleMode" class="mode-btn">&#x1F319;</button>
    </header>
    <main>
      <div class="app-title">
        <img src="soulify-logo.png" alt="Soulify Logo" class="app-logo">
        <h1>Soulify</h1>
      </div>
      <div class="button-container">
        <button id="startChatBtn" class="start-btn" onclick="startChat()">Start Chatting</button>
      </div>
    </main>
    <footer>
      <div class="powered-by">
        <p>Powered by <img src="devkart-logo.png" alt="Devkart Logo" class="powered-logo"> Devkart</p>
      </div>
      <div class="contact-info">
        <div class="social-media">
          <a href="https://www.instagram.com/devkart_shop?igsh=MWVrNGZ6bmhhamQ5NA==" target="_blank">
            <img src="instagram-logo.png" alt="Instagram Logo" class="contact-logo">
          </a>
          <a href="https://www.facebook.com/profile.php?id=61563526481623&mibextid=ZbWKwL" target="_blank">
            <img src="facebook-logo.png" alt="Facebook Logo" class="contact-logo">
          </a>
        </div>
        <p>Email: devkart77@gmail.com</p>
      </div>
    </footer>
  </div>
  <script>
    // Check if user has completed setup
    const checkUserSetup = () => {
      const userData = localStorage.getItem('soulifyUser');
      if (!userData) {
        window.location.href = '/setup';
        return false;
      }
      return true;
    };

    // Function to navigate to the chat page
    function startChat() {
      if (checkUserSetup()) {
        window.location.href = '/talk$dsw';
      }
    }

    // Check setup on page load
    if (!checkUserSetup()) {
      // Will redirect to setup
    }

    // Socket.IO initialization
    const socket = io();

    // Update online user count
    socket.on('updateOnlineUsers', (count) => {
      document.getElementById('onlineCount').textContent = count;
    });

    // Dark/Light Mode Toggle
    const toggleButton = document.getElementById('toggleMode');
    toggleButton.addEventListener('click', () => {
      document.body.classList.toggle('dark-mode');
      if (document.body.classList.contains('dark-mode')) {
        toggleButton.innerHTML = '&#x2600;';
      } else {
        toggleButton.innerHTML = '&#x1F319;';
      }
    });
  </script>
  <script>
    // Check if user has set up their username
    document.addEventListener('DOMContentLoaded', () => {
      const hasUsername = localStorage.getItem('soulify_username');
      if (!hasUsername) {
        // First time user, redirect to setup
        document.querySelector('.start-btn').addEventListener('click', (e) => {
          e.preventDefault();
          window.location.href = '/setup';
        });
      }
    });
  </script>
</body>
</html>